<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PPTX2HTML</title>

<!-- Bootstrap CSS -->
<link href="css/bootstrap.min.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="stylesheet" href="./css/font-awesome.min.css">

<link rel="stylesheet" href="./css/highlight.min.css">
<link rel="stylesheet" href="./css/pptx2html.css">

<script type="text/javascript" src="./js/jszip.min.js"></script>
<script type="text/javascript" src="./js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="./js/highlight.min.js"></script>
<script type="text/javascript" src="./js/vkbeautify.js"></script>
<script type="text/javascript" src="./js/colz.class.min.js"></script>

</head>

<body>
	
	<div class="container">
		
		<div class="header">
			<ul class="nav nav-pills pull-right">
				<li class="active"><a href="#"><i class="glyphicon glyphicon-home"></i> Home</a></li>
				<li><a href="https://github.com/g21589/PPTX2HTML"><i class="fa fa-github"></i> Github</a></li>
			</ul>
			<h2 class="text-muted">PPTX2HTML</h2>
		</div>
		
		<div class="jumbotron">
			<h1>PPTX2HTML</h1>
			<p class="lead">轉換PPTX到HTML格式</p>
		</div>
		
		<div class="row">
			<div class="col-lg-12">
				<h3>選取PPTX檔案</h3>
				<div class="fileUpload btn btn-primary">
					<span><i class="glyphicon glyphicon-upload"></i> Upload</span>
					<input id="uploadBtn" type="file" class="upload" />
				</div>
				<button type="button" class="btn btn-success"><i class="glyphicon glyphicon-download-alt"></i> Download Slides</button>
			</div>
			<div class="col-lg-12">
				<img id="pptx-thumb" class="img-thumbnail" src="" alt="">
			</div>
		</div>
		
		<br>
		
		<!--div class="row">
			<div class="col-lg-12">
				<div class="progress">
					<div id="load-progress" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
						60%
					</div>
				</div>
			</div>
		</div-->
		
		<div class="row">
			<div class="col-lg-12">
				<div id="error_block" class="alert alert-danger hidden">
					You will need a recent browser to use this demo :(
				</div>
				<div id="info_block" class="alert alert-success" role="alert">
				
				</div>
				<div id="result_block" class="hidden">
					<h3>內容 :</h3>
					<div id="result"></div>
				</div>
			</div>
		</div>
		
		<div class="footer">
			<hr>
			<p>Copyright © 2015 g21589, All Rights Reserved.<br>Contact Person: g21589, E-mail: g21589@gmail.com</p>
		</div>
		
	</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script type="text/javascript" src="js/bootstrap.min.js"></script>

<!--script type="text/javascript" src="./js/pptx2html.js"></script-->

<script type="text/javascript">
if (window.Worker) {
	
	var $result = $("#result");
	$("#uploadBtn").on("change", function(evt) {

		$result.html("");
		$("#result_block").removeClass("hidden").addClass("show");
		
		var fileName = evt.target.files[0];
		
		// Read the file
		var reader = new FileReader();
		reader.onload = (function(theFile) {
			return function(e) {
				
				// Web Worker
				var worker = new Worker('./js/worker.js');
			
				worker.addEventListener('message', function(e) {
					
					var msg = e.data;
					
					switch(msg.type) {
						case "pptx-thumb":
							$("#pptx-thumb").attr("src", "data:image/jpeg;base64," + msg.data);
							break;
						case "WARN":
							console.warn('Worker: ', msg.data);
							break;
						case "ERROR":
							console.error('Worker: ', msg.data);
							$("#error_block").text(msg.data);
							break;
						case "INFO":
						default:
							console.info('Worker: ', msg.data);
							$("#info_block").text(msg.data);
					}
					
				}, false);
				
				worker.postMessage(e.target.result);
				
			}
		})(fileName);
		reader.readAsArrayBuffer(fileName);
		
	});
	
}
</script>

</body>
</html>
